{% extends 'base.html.twig' %}

{% block title %}{{ 'pi_crud.list.meta_title'|trans({'entity_label': type}) }}{% endblock %}
{% block meta_description %}{{ 'pi_crud.list.meta_description'|trans({'entity_label': type}) }}{% endblock %}

{% block content %}
    <div class="container-xl py-2 py-lg-4">
        {{ render(path('pi_breadcrumb_block')) }}

        {% block content_body_title %}
            <h1>{{ 'pi_crud.list.title'|trans({'entity_label': type}) }}</h1>
        {% endblock content_body_title %}

        {% block content_body_description %}
        {% endblock content_body_description %}

        {% block content_body_search_form %}
            {% if searchForm is defined and searchForm is not empty %}
                {{ form_start(searchForm) }}
                <div class="row">
                    {% for field, property in configuration.properties|filter(a => a.search is defined and a.search is not empty) %}
                        <div class="col-12 col-md-6 col-lg-4 {{ property.search.class ?? 'order-12' }}">
                            {% include templates['field_' ~ field] ?? templates['field_' ~ property.type] ?? templates['field_default'] ?? '@PiCRUD/fields/field_default.html.twig' ignore missing with {'field': searchForm[field], 'configuration': property} %}
                        </div>
                    {% endfor %}
                </div>
                <div class="d-none">
                    {{ form_rest(searchForm)}}
                </div>
                <button type="submit" class="btn btn-primary mt-0"><i class="fa fa-search"></i> {{ 'pi_crud.list.filter'|trans({'entity_label': type}) }}</button>
                {% block form_extra_link %}{% endblock %}
                {{ form_end(searchForm) }}
            {% endif %}
        {% endblock content_body_search_form %}

        <div class="row pt-4">
            {% for entity in entities %}
                {% if is_granted('show', entity) %}
                    {{ render(path('pi_crud_item', {
                        'id': entity.id,
                        'type': type,
                        'format': 'default',
                        'attr': {'class': 'col-12 col-md-6 col-lg-4'}
                    })) }}
                {% endif %}
            {% else %}
                <div class="col-12">
                    <p class="lead">{{ 'pi_crud.list.empty_result'|trans({'entity_label': type}) }}</p>
                </div>
            {% endfor %}
        </div>
    </div>
{% endblock %}
